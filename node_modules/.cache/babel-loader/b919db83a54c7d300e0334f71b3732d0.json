{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\emili\\\\Desktop\\\\a\\\\proyecto\\\\src\\\\components\\\\Agenda\\\\AgendarServicio.js\";\nimport React, { Component } from 'react';\nimport * as ReactBoostrap from 'react-bootstrap';\nimport axios from 'axios';\nimport { url } from '../API.js';\nimport DayPicker from 'react-day-picker';\nimport 'react-day-picker/lib/style.css';\nimport { Redirect } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class AgendarServicio extends Component {\n  constructor(props) {\n    super(props);\n\n    this.manejadorBoton = e => {\n      e.preventDefault();\n      console.log(this.state.idSer);\n      console.log(localStorage.getItem('usuario') + 'id del usuario');\n      console.log(this.state.selectedDay);\n      console.log(this.state.horarioElegido);\n\n      if (this.handleValidation()) {\n        axios.post(url + '/servicioAgendado/insertar?idSer=' + this.state.idSer + \"&idUsu=\" + localStorage.getItem('usuario') + \"&fechaElegida=\" + this.state.selectedDay.toLocaleDateString() + \"&horarioElegido=\" + this.state.horarioElegido).then(response => {\n          if (response.status === 200) {\n            this.setState({\n              mensaje: \"Ingreso Correcto\",\n              mensajeSuccess: \"ok\"\n            });\n          } else {\n            this.setState({\n              mensaje: \"Ingreso Incorrecto\",\n              mensajeError: \"error\"\n            });\n          }\n        }).catch(error => {\n          console.log(error);\n          this.setState({\n            mensaje: \"Ingreso Incorrecto\",\n            mensajeError: \"error\"\n          });\n        });\n      }\n    };\n\n    this.componentDidMount = () => {\n      axios.get(url + '/servicio/listarActivos').then(resp => {\n        this.setState({\n          servicios: resp.data\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n      axios.get(url + '/servicioAgendado/listarActivos').then(resp => {\n        this.setState({\n          serviciosAgendados: resp.data\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n      axios.get(url + '/servicioAgendado/listarAgenda?num=3').then(resp => {\n        this.setState({\n          serviciosFull: resp.data\n        });\n        this.cargarFecha();\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.cargarFecha = () => {\n      const today = new Date();\n      const fechasAntes = [{\n        before: today\n      }];\n      const fechas = fechasAntes;\n      this.state.serviciosFull.forEach(e => {\n        fechas.push(new Date(e));\n      });\n      this.setState({\n        fechasConvertidas: fechas\n      });\n    };\n\n    this.handleChange = event => {\n      if (event.target.value == 3) {\n        this.setState({\n          horas: [{\n            hora: '9 am'\n          }]\n        });\n      } else {\n        this.setState({\n          horas: this.state.horarios\n        });\n      }\n\n      this.setState({\n        idSer: event.target.value\n      });\n    };\n\n    this.changeHorario = event => {\n      this.setState({\n        horarioElegido: event.target.value\n      });\n    };\n\n    this.handleDayClick = (day, {\n      selected,\n      disabled\n    }) => {\n      if (disabled) {\n        return;\n      }\n\n      if (selected) {\n        this.setState({\n          selectedDay: undefined\n        });\n        return;\n      } else {\n        this.setState({\n          selectedDay: day\n        });\n        this.llamarDia(day);\n      }\n    };\n\n    this.llamarDia = day => {\n      this.setState({\n        horas: this.state.horarios\n      });\n      axios.get(url + '/servicioAgendado/llamarServicioDia?dia=' + day.toLocaleDateString()).then(resp => {\n        console.log(resp.data);\n        this.setState({\n          servicioDia: resp.data\n        });\n        this.cargarFecha();\n        this.borrarHoras(resp.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.borrarHoras = servicioDia => {\n      let array = this.state.horas;\n      servicioDia.forEach(e => {\n        if (e.servicioId === 1) {\n          let h = e.horaElegida;\n          array = array.filter(element => element.hora !== h);\n        } else if (e.servicioId === 2) {\n          let j = e.horaElegida;\n          console.log(j);\n        }\n      });\n      this.setState({\n        horas: array\n      });\n    };\n\n    this.state = {\n      diaElegido: '',\n      servicios: [],\n      servicioElegido: \"\",\n      mensaje: \"\",\n      idCli: 0,\n      serviciosFull: [],\n      serviciosMedios: [],\n      serviciosBasicos: [],\n      selectedDay: \"\",\n      serviciosAgendados: [],\n      fechasConvertidas: {},\n      idSer: -1,\n      mensajeError: \"\",\n      mensajeSuccess: \"\",\n      horas: [],\n      horarios: [{\n        hora: \"9 am\"\n      }, {\n        hora: \"10 am\"\n      }, {\n        hora: \"11 am\"\n      }, {\n        hora: \"12 am\"\n      }, {\n        hora: \"2 pm\"\n      }, {\n        hora: \"3 pm\"\n      }, {\n        hora: \"4 pm\"\n      }, {\n        hora: \"5 pm\"\n      }, {\n        hora: \"6 pm\"\n      }],\n      horarioElegido: \"\",\n      servicioDia: [],\n      errors: {}\n    };\n  }\n\n  handleValidation() {\n    let fields = this.state.fields;\n    let errors = {};\n    let formIsValid = true; //idSer\n\n    if (this.state.idSer == -1) {\n      formIsValid = false;\n      errors[\"idSer\"] = \"Debe ingresar el servicio que desea agendar!!!\";\n    } //fechaElegida\n\n\n    if (this.state.selectedDay === \"\") {\n      formIsValid = false;\n      errors[\"fechaElegida\"] = \"Debe ingresar la fecha en la que desea agendarse!!!\";\n    } //horarioElegido\n\n\n    if (this.state.horarioElegido === \"\") {\n      formIsValid = false;\n      errors[\"horarioElegido\"] = \"Debe ingresar el horario en el que desea agendarse!!!\";\n    }\n\n    this.setState({\n      errors: errors\n    });\n    return formIsValid;\n  }\n\n  render() {\n    if (localStorage.getItem('usuario') == null) {\n      return /*#__PURE__*/_jsxDEV(Redirect, {\n        to: window.location.href = '/Login'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 21\n      }, this);\n    } else //var holydays = [new Date('08/22/2021'), new Date('08/25/2021'), new Date('08/29/2021')];       \n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Agende su servicio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            id: \"labeles\",\n            className: \"lead\",\n            children: \"Agende su servicio\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"red\"\n            },\n            children: this.state.errors[\"idSer\"]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"\",\n            children: [/*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"idSer\",\n              onChange: this.handleChange,\n              className: \"form-control\",\n              placeholderText: \"Servicios\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                disabled: true,\n                selected: true,\n                children: \"Eliga un servicio\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 29\n              }, this), this.state.servicios.map(servicioElegido => /*#__PURE__*/_jsxDEV(\"option\", {\n                name: \"servicio\",\n                value: servicioElegido.id,\n                selectedValue: servicioElegido,\n                children: servicioElegido.nombre\n              }, servicioElegido, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 33\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: this.submit,\n              children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: \"red\"\n                },\n                children: this.state.errors[\"fechaElegida\"]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(DayPicker, {\n                  id: \"fechaElegida\",\n                  onDayClick: this.handleDayClick,\n                  selectedDays: this.state.selectedDay,\n                  disabledDays: this.state.fechasConvertidas\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 33\n                }, this), this.state.selectedDay ? /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: this.state.selectedDay.toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 37\n                }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Elija un d\\xEDa.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                id: \"labeles\",\n                className: \"lead\",\n                children: \"Ingrese su horario\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: \"red\"\n                },\n                children: this.state.errors[\"horarioElegido\"]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                onChange: this.changeHorario,\n                id: \"horarioElegido\",\n                className: \"form-control\",\n                placeholderText: \"Horarios\",\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  disabled: true,\n                  selected: true,\n                  children: \"Eliga un horario\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 263,\n                  columnNumber: 33\n                }, this), this.state.horas.map(horario => /*#__PURE__*/_jsxDEV(\"option\", {\n                  name: \"horario\",\n                  value: horario.hora,\n                  selectedValue: horario,\n                  children: horario.hora\n                }, horario, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 37\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(ReactBoostrap.Button, {\n                type: \"submit\",\n                variant: \"success\",\n                className: \"fadeIn fourth\",\n                value: \"Crear Servicio\",\n                onClick: this.manejadorBoton,\n                children: \"Agendar Servicio\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 25\n            }, this), this.state.mensajeSuccess === \"ok\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"alert alert-success\",\n              role: \"alert\",\n              children: this.state.mensaje\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 29\n            }, this) : this.state.mensajeError === \"error\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"alert alert-danger\",\n              role: \"alert\",\n              children: this.state.mensaje\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 33\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 13\n      }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/emili/Desktop/a/proyecto/src/components/Agenda/AgendarServicio.js"],"names":["React","Component","ReactBoostrap","axios","url","DayPicker","Redirect","AgendarServicio","constructor","props","manejadorBoton","e","preventDefault","console","log","state","idSer","localStorage","getItem","selectedDay","horarioElegido","handleValidation","post","toLocaleDateString","then","response","status","setState","mensaje","mensajeSuccess","mensajeError","catch","error","componentDidMount","get","resp","servicios","data","serviciosAgendados","serviciosFull","cargarFecha","today","Date","fechasAntes","before","fechas","forEach","push","fechasConvertidas","handleChange","event","target","value","horas","hora","horarios","changeHorario","handleDayClick","day","selected","disabled","undefined","llamarDia","servicioDia","borrarHoras","array","servicioId","h","horaElegida","filter","element","j","diaElegido","servicioElegido","idCli","serviciosMedios","serviciosBasicos","errors","fields","formIsValid","render","window","location","href","color","map","id","nombre","submit","horario"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,KAAKC,aAAZ,MAA+B,iBAA/B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,QAAoB,WAApB;AACA,OAAOC,SAAP,MAAsB,kBAAtB;AACA,OAAO,gCAAP;AACA,SAASC,QAAT,QAAwB,kBAAxB;;AAIA,eAAe,MAAMC,eAAN,SAA8BN,SAA9B,CAAwC;AAEnDO,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SA8DnBC,cA9DmB,GA8DDC,CAAD,IAAO;AACpBA,MAAAA,CAAC,CAACC,cAAF;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAL,CAAWC,KAAvB;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAYG,YAAY,CAACC,OAAb,CAAqB,SAArB,IAAkC,gBAA9C;AACAL,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAL,CAAWI,WAAvB;AACAN,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAL,CAAWK,cAAvB;;AACA,UAAI,KAAKC,gBAAL,EAAJ,EAA6B;AACzBlB,QAAAA,KAAK,CAACmB,IAAN,CAAWlB,GAAG,GAAG,mCAAN,GAA4C,KAAKW,KAAL,CAAWC,KAAvD,GAA+D,SAA/D,GAA2EC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAA3E,GACL,gBADK,GACc,KAAKH,KAAL,CAAWI,WAAX,CAAuBI,kBAAvB,EADd,GAC4D,kBAD5D,GACiF,KAAKR,KAAL,CAAWK,cADvG,EAEKI,IAFL,CAEUC,QAAQ,IACV;AACA,cAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;AACzB,iBAAKC,QAAL,CAAc;AAAEC,cAAAA,OAAO,EAAE,kBAAX;AAA+BC,cAAAA,cAAc,EAAE;AAA/C,aAAd;AACH,WAFD,MAEM;AACF,iBAAKF,QAAL,CAAc;AAAEC,cAAAA,OAAO,EAAE,oBAAX;AAAgCE,cAAAA,YAAY,EAAC;AAA7C,aAAd;AACH;AACJ,SATL,EASOC,KATP,CASaC,KAAK,IAAI;AACdnB,UAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACA,eAAKL,QAAL,CAAc;AAAEC,YAAAA,OAAO,EAAE,oBAAX;AAAiCE,YAAAA,YAAY,EAAE;AAA/C,WAAd;AACH,SAZL;AAaH;AACJ,KAnFkB;;AAAA,SAqFnBG,iBArFmB,GAqFC,MAAM;AACtB9B,MAAAA,KAAK,CAAC+B,GAAN,CAAU9B,GAAG,GAAG,yBAAhB,EAA2CoB,IAA3C,CAAiDW,IAAD,IAAU;AACtD,aAAKR,QAAL,CAAc;AACVS,UAAAA,SAAS,EAAED,IAAI,CAACE;AADN,SAAd;AAGH,OAJD,EAIGN,KAJH,CAIUC,KAAD,IAAW;AAChBnB,QAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACH,OAND;AAQA7B,MAAAA,KAAK,CAAC+B,GAAN,CAAU9B,GAAG,GAAG,iCAAhB,EAAmDoB,IAAnD,CAAyDW,IAAD,IAAU;AAC9D,aAAKR,QAAL,CAAc;AACVW,UAAAA,kBAAkB,EAAEH,IAAI,CAACE;AADf,SAAd;AAGH,OAJD,EAIGN,KAJH,CAIUC,KAAD,IAAW;AAChBnB,QAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACH,OAND;AAQA7B,MAAAA,KAAK,CAAC+B,GAAN,CAAU9B,GAAG,GAAG,sCAAhB,EAAwDoB,IAAxD,CAA8DW,IAAD,IAAU;AACnE,aAAKR,QAAL,CAAc;AACVY,UAAAA,aAAa,EAAEJ,IAAI,CAACE;AADV,SAAd;AAGA,aAAKG,WAAL;AACH,OALD,EAKGT,KALH,CAKUC,KAAD,IAAW;AAChBnB,QAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACH,OAPD;AASH,KA/GkB;;AAAA,SAmHnBQ,WAnHmB,GAmHL,MAAM;AAChB,YAAMC,KAAK,GAAG,IAAIC,IAAJ,EAAd;AACA,YAAMC,WAAW,GAAG,CAAC;AAAEC,QAAAA,MAAM,EAAEH;AAAV,OAAD,CAApB;AACA,YAAMI,MAAM,GAAGF,WAAf;AACA,WAAK5B,KAAL,CAAWwB,aAAX,CAAyBO,OAAzB,CAAiCnC,CAAC,IAAI;AAClCkC,QAAAA,MAAM,CAACE,IAAP,CAAY,IAAIL,IAAJ,CAAS/B,CAAT,CAAZ;AACH,OAFD;AAGA,WAAKgB,QAAL,CAAc;AACVqB,QAAAA,iBAAiB,EAAEH;AADT,OAAd;AAGH,KA7HkB;;AAAA,SA+HnBI,YA/HmB,GA+HJC,KAAK,IAAI;AACpB,UAAIA,KAAK,CAACC,MAAN,CAAaC,KAAb,IAAsB,CAA1B,EAA6B;AACzB,aAAKzB,QAAL,CAAc;AACV0B,UAAAA,KAAK,EAAE,CAAC;AAAEC,YAAAA,IAAI,EAAE;AAAR,WAAD;AADG,SAAd;AAGH,OAJD,MAIO;AACH,aAAK3B,QAAL,CAAc;AACV0B,UAAAA,KAAK,EAAE,KAAKtC,KAAL,CAAWwC;AADR,SAAd;AAGH;;AACD,WAAK5B,QAAL,CAAc;AACVX,QAAAA,KAAK,EAAEkC,KAAK,CAACC,MAAN,CAAaC;AADV,OAAd;AAGH,KA5IkB;;AAAA,SA8InBI,aA9ImB,GA8IHN,KAAK,IAAI;AACrB,WAAKvB,QAAL,CAAc;AACVP,QAAAA,cAAc,EAAE8B,KAAK,CAACC,MAAN,CAAaC;AADnB,OAAd;AAGH,KAlJkB;;AAAA,SAoJnBK,cApJmB,GAoJF,CAACC,GAAD,EAAM;AAAEC,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,KAAN,KAAiC;AAC9C,UAAIA,QAAJ,EAAc;AACV;AACH;;AACD,UAAID,QAAJ,EAAc;AACV,aAAKhC,QAAL,CAAc;AAAER,UAAAA,WAAW,EAAE0C;AAAf,SAAd;AACA;AACH,OAHD,MAGM;AACF,aAAKlC,QAAL,CAAc;AACVR,UAAAA,WAAW,EAAEuC;AADH,SAAd;AAIJ,aAAKI,SAAL,CAAeJ,GAAf;AACC;AAEJ,KAnKkB;;AAAA,SAqKnBI,SArKmB,GAqKNJ,GAAD,IAAS;AACjB,WAAK/B,QAAL,CAAc;AACV0B,QAAAA,KAAK,EAAC,KAAKtC,KAAL,CAAWwC;AADP,OAAd;AAGApD,MAAAA,KAAK,CAAC+B,GAAN,CAAU9B,GAAG,GAAG,0CAAN,GAAmDsD,GAAG,CAACnC,kBAAJ,EAA7D,EAAuFC,IAAvF,CAA6FW,IAAD,IAAU;AAClGtB,QAAAA,OAAO,CAACC,GAAR,CAAYqB,IAAI,CAACE,IAAjB;AACA,aAAKV,QAAL,CAAc;AACVoC,UAAAA,WAAW,EAAE5B,IAAI,CAACE;AADR,SAAd;AAGA,aAAKG,WAAL;AACA,aAAKwB,WAAL,CAAiB7B,IAAI,CAACE,IAAtB;AACH,OAPD,EAOGN,KAPH,CAOUC,KAAD,IAAW;AAChBnB,QAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACH,OATD;AAWH,KApLkB;;AAAA,SAsLnBgC,WAtLmB,GAsLJD,WAAD,IAAiB;AAC3B,UAAIE,KAAK,GAAG,KAAKlD,KAAL,CAAWsC,KAAvB;AACAU,MAAAA,WAAW,CAACjB,OAAZ,CAAoBnC,CAAC,IAAI;AACrB,YAAIA,CAAC,CAACuD,UAAF,KAAiB,CAArB,EAAwB;AACpB,cAAIC,CAAC,GAAGxD,CAAC,CAACyD,WAAV;AACAH,UAAAA,KAAK,GAAGA,KAAK,CAACI,MAAN,CAAaC,OAAO,IAAIA,OAAO,CAAChB,IAAR,KAAiBa,CAAzC,CAAR;AACH,SAHD,MAGO,IAAIxD,CAAC,CAACuD,UAAF,KAAiB,CAArB,EAAwB;AAC3B,cAAIK,CAAC,GAAG5D,CAAC,CAACyD,WAAV;AACAvD,UAAAA,OAAO,CAACC,GAAR,CAAYyD,CAAZ;AACH;AACJ,OARD;AASA,WAAK5C,QAAL,CAAc;AACV0B,QAAAA,KAAK,EAAEY;AADG,OAAd;AAGH,KApMkB;;AAEf,SAAKlD,KAAL,GAAa;AACTyD,MAAAA,UAAU,EAAE,EADH;AAETpC,MAAAA,SAAS,EAAE,EAFF;AAGTqC,MAAAA,eAAe,EAAE,EAHR;AAIT7C,MAAAA,OAAO,EAAE,EAJA;AAKT8C,MAAAA,KAAK,EAAE,CALE;AAMTnC,MAAAA,aAAa,EAAE,EANN;AAOToC,MAAAA,eAAe,EAAE,EAPR;AAQTC,MAAAA,gBAAgB,EAAE,EART;AASTzD,MAAAA,WAAW,EAAE,EATJ;AAUTmB,MAAAA,kBAAkB,EAAE,EAVX;AAWTU,MAAAA,iBAAiB,EAAE,EAXV;AAYThC,MAAAA,KAAK,EAAG,CAAC,CAZA;AAaTc,MAAAA,YAAY,EAAE,EAbL;AAcTD,MAAAA,cAAc,EAAE,EAdP;AAeTwB,MAAAA,KAAK,EAAE,EAfE;AAgBTE,MAAAA,QAAQ,EAAE,CACN;AAAED,QAAAA,IAAI,EAAE;AAAR,OADM,EAEN;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAFM,EAGN;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAHM,EAIN;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAJM,EAKN;AAAEA,QAAAA,IAAI,EAAE;AAAR,OALM,EAMN;AAAEA,QAAAA,IAAI,EAAE;AAAR,OANM,EAON;AAAEA,QAAAA,IAAI,EAAE;AAAR,OAPM,EAQN;AAAEA,QAAAA,IAAI,EAAE;AAAR,OARM,EASN;AAAEA,QAAAA,IAAI,EAAE;AAAR,OATM,CAhBD;AA2BTlC,MAAAA,cAAc,EAAE,EA3BP;AA4BT2C,MAAAA,WAAW,EAAC,EA5BH;AA6BTc,MAAAA,MAAM,EAAC;AA7BE,KAAb;AA+BH;;AAEDxD,EAAAA,gBAAgB,GAAE;AACd,QAAIyD,MAAM,GAAG,KAAK/D,KAAL,CAAW+D,MAAxB;AACA,QAAID,MAAM,GAAG,EAAb;AACA,QAAIE,WAAW,GAAG,IAAlB,CAHc,CAKd;;AACA,QAAI,KAAKhE,KAAL,CAAWC,KAAX,IAAoB,CAAC,CAAzB,EAA4B;AACzB+D,MAAAA,WAAW,GAAG,KAAd;AACAF,MAAAA,MAAM,CAAC,OAAD,CAAN,GAAkB,gDAAlB;AACF,KATa,CAWd;;;AACA,QAAI,KAAK9D,KAAL,CAAWI,WAAX,KAA2B,EAA/B,EAAmC;AAC/B4D,MAAAA,WAAW,GAAG,KAAd;AACAF,MAAAA,MAAM,CAAC,cAAD,CAAN,GAAyB,qDAAzB;AACH,KAfa,CAiBd;;;AACA,QAAI,KAAK9D,KAAL,CAAWK,cAAX,KAA8B,EAAlC,EAAsC;AAClC2D,MAAAA,WAAW,GAAG,KAAd;AACAF,MAAAA,MAAM,CAAC,gBAAD,CAAN,GAA2B,uDAA3B;AACH;;AAED,SAAKlD,QAAL,CAAc;AAACkD,MAAAA,MAAM,EAAEA;AAAT,KAAd;AACA,WAAOE,WAAP;AACH;;AA2IDC,EAAAA,MAAM,GAAG;AACL,QAAG/D,YAAY,CAACC,OAAb,CAAqB,SAArB,KAAmC,IAAtC,EAA2C;AACvC,0BAAQ,QAAC,QAAD;AAAU,QAAA,EAAE,EAAE+D,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAqB;AAAnC;AAAA;AAAA;AAAA;AAAA,cAAR;AACH,KAFD,MAGA;AACA,0BACI;AAAA,gCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA,kCACI;AAAO,YAAA,EAAE,EAAC,SAAV;AAAoB,YAAA,SAAS,EAAC,MAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAM,YAAA,KAAK,EAAE;AAACC,cAAAA,KAAK,EAAE;AAAR,aAAb;AAAA,sBAA8B,KAAKrE,KAAL,CAAW8D,MAAX,CAAkB,OAAlB;AAA9B;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI;AAAK,YAAA,SAAS,EAAC,EAAf;AAAA,oCACI;AACI,cAAA,EAAE,EAAC,OADP;AAEI,cAAA,QAAQ,EAAE,KAAK5B,YAFnB;AAGI,cAAA,SAAS,EAAC,cAHd;AAII,cAAA,eAAe,EAAC,WAJpB;AAAA,sCAKI;AAAQ,gBAAA,QAAQ,MAAhB;AAAiB,gBAAA,QAAQ,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBALJ,EAMK,KAAKlC,KAAL,CAAWqB,SAAX,CAAqBiD,GAArB,CAAyBZ,eAAe,iBACrC;AAEI,gBAAA,IAAI,EAAC,UAFT;AAGI,gBAAA,KAAK,EAAEA,eAAe,CAACa,EAH3B;AAII,gBAAA,aAAa,EAAEb,eAJnB;AAAA,0BAKEA,eAAe,CAACc;AALlB,iBACSd,eADT;AAAA;AAAA;AAAA;AAAA,sBADH,CANL;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,eAgBI;AAAA;AAAA;AAAA;AAAA,oBAhBJ,eAiBI;AAAM,cAAA,QAAQ,EAAE,KAAKe,MAArB;AAAA,sCACI;AAAA;AAAA;AAAA;AAAA,sBADJ,eAEI;AAAM,gBAAA,KAAK,EAAE;AAACJ,kBAAAA,KAAK,EAAE;AAAR,iBAAb;AAAA,0BAA8B,KAAKrE,KAAL,CAAW8D,MAAX,CAAkB,cAAlB;AAA9B;AAAA;AAAA;AAAA;AAAA,sBAFJ,eAGI;AAAA,wCACI,QAAC,SAAD;AACI,kBAAA,EAAE,EAAC,cADP;AAEI,kBAAA,UAAU,EAAE,KAAKpB,cAFrB;AAGI,kBAAA,YAAY,EAAE,KAAK1C,KAAL,CAAWI,WAH7B;AAII,kBAAA,YAAY,EAAE,KAAKJ,KAAL,CAAWiC;AAJ7B;AAAA;AAAA;AAAA;AAAA,wBADJ,EAOK,KAAKjC,KAAL,CAAWI,WAAX,gBACG;AAAA,4BAAI,KAAKJ,KAAL,CAAWI,WAAX,CAAuBI,kBAAvB;AAAJ;AAAA;AAAA;AAAA;AAAA,wBADH,gBAGG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAVR;AAAA;AAAA;AAAA;AAAA;AAAA,sBAHJ,eAgBI;AAAA;AAAA;AAAA;AAAA,sBAhBJ,eAiBI;AAAO,gBAAA,EAAE,EAAC,SAAV;AAAoB,gBAAA,SAAS,EAAC,MAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAjBJ,eAkBI;AAAM,gBAAA,KAAK,EAAE;AAAC6D,kBAAAA,KAAK,EAAE;AAAR,iBAAb;AAAA,0BAA8B,KAAKrE,KAAL,CAAW8D,MAAX,CAAkB,gBAAlB;AAA9B;AAAA;AAAA;AAAA;AAAA,sBAlBJ,eAmBI;AAAQ,gBAAA,QAAQ,EAAE,KAAKrB,aAAvB;AACI,gBAAA,EAAE,EAAC,gBADP;AAEI,gBAAA,SAAS,EAAC,cAFd;AAGI,gBAAA,eAAe,EAAC,UAHpB;AAAA,wCAII;AAAQ,kBAAA,QAAQ,MAAhB;AAAiB,kBAAA,QAAQ,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAJJ,EAKK,KAAKzC,KAAL,CAAWsC,KAAX,CAAiBgC,GAAjB,CAAqBI,OAAO,iBACzB;AAEI,kBAAA,IAAI,EAAC,SAFT;AAGI,kBAAA,KAAK,EAAEA,OAAO,CAACnC,IAHnB;AAII,kBAAA,aAAa,EAAEmC,OAJnB;AAAA,4BAKEA,OAAO,CAACnC;AALV,mBACSmC,OADT;AAAA;AAAA;AAAA;AAAA,wBADH,CALL;AAAA;AAAA;AAAA;AAAA;AAAA,sBAnBJ,eAiCI;AAAA;AAAA;AAAA;AAAA,sBAjCJ,eAkCI,QAAC,aAAD,CAAe,MAAf;AAAsB,gBAAA,IAAI,EAAC,QAA3B;AAAoC,gBAAA,OAAO,EAAC,SAA5C;AAAsD,gBAAA,SAAS,EAAC,eAAhE;AAAgF,gBAAA,KAAK,EAAC,gBAAtF;AACI,gBAAA,OAAO,EAAE,KAAK/E,cADlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAlCJ;AAAA;AAAA;AAAA;AAAA;AAAA,oBAjBJ,EAuDK,KAAKK,KAAL,CAAWc,cAAX,KAA8B,IAA9B,gBACG;AAAK,cAAA,KAAK,EAAC,qBAAX;AAAiC,cAAA,IAAI,EAAC,OAAtC;AAAA,wBACK,KAAKd,KAAL,CAAWa;AADhB;AAAA;AAAA;AAAA;AAAA,oBADH,GAGa,KAAKb,KAAL,CAAWe,YAAX,KAA4B,OAA7B,gBACL;AAAK,cAAA,KAAK,EAAC,oBAAX;AAAgC,cAAA,IAAI,EAAC,OAArC;AAAA,wBACK,KAAKf,KAAL,CAAWa;AADhB;AAAA;AAAA;AAAA;AAAA,oBADK,GAGI,IA7DrB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ;AAyEH;;AAvRkD","sourcesContent":["import React, { Component } from 'react';\r\nimport * as ReactBoostrap from 'react-bootstrap';\r\nimport axios from 'axios'\r\nimport { url } from '../API.js';\r\nimport DayPicker from 'react-day-picker';\r\nimport 'react-day-picker/lib/style.css';\r\nimport { Redirect} from \"react-router-dom\";\r\n\r\n\r\n\r\nexport default class AgendarServicio extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            diaElegido: '',\r\n            servicios: [],\r\n            servicioElegido: \"\",\r\n            mensaje: \"\",\r\n            idCli: 0,\r\n            serviciosFull: [],\r\n            serviciosMedios: [],\r\n            serviciosBasicos: [],\r\n            selectedDay: \"\",\r\n            serviciosAgendados: [],\r\n            fechasConvertidas: {},\r\n            idSer: (-1),\r\n            mensajeError: \"\",\r\n            mensajeSuccess: \"\",\r\n            horas: [],\r\n            horarios: [\r\n                { hora: \"9 am\" },\r\n                { hora: \"10 am\" },\r\n                { hora: \"11 am\" },\r\n                { hora: \"12 am\" },\r\n                { hora: \"2 pm\" },\r\n                { hora: \"3 pm\" },\r\n                { hora: \"4 pm\" },\r\n                { hora: \"5 pm\" },\r\n                { hora: \"6 pm\" },\r\n            ],\r\n            horarioElegido: \"\",\r\n            servicioDia:[],\r\n            errors:{},\r\n        }\r\n    }\r\n\r\n    handleValidation(){\r\n        let fields = this.state.fields;\r\n        let errors = {};\r\n        let formIsValid = true;\r\n\r\n        //idSer\r\n        if (this.state.idSer == -1) {\r\n           formIsValid = false;\r\n           errors[\"idSer\"] = \"Debe ingresar el servicio que desea agendar!!!\";           \r\n        }   \r\n\r\n        //fechaElegida\r\n        if (this.state.selectedDay === \"\") {\r\n            formIsValid = false;\r\n            errors[\"fechaElegida\"] = \"Debe ingresar la fecha en la que desea agendarse!!!\";           \r\n        }\r\n\r\n        //horarioElegido\r\n        if (this.state.horarioElegido === \"\") {\r\n            formIsValid = false;\r\n            errors[\"horarioElegido\"] = \"Debe ingresar el horario en el que desea agendarse!!!\";           \r\n        }\r\n \r\n        this.setState({errors: errors});\r\n        return formIsValid;\r\n    }\r\n\r\n    manejadorBoton = (e) => {\r\n        e.preventDefault();\r\n        console.log(this.state.idSer)\r\n        console.log(localStorage.getItem('usuario') + 'id del usuario')\r\n        console.log(this.state.selectedDay)\r\n        console.log(this.state.horarioElegido)\r\n        if (this.handleValidation()) { \r\n            axios.post(url + '/servicioAgendado/insertar?idSer=' + this.state.idSer + \"&idUsu=\" + localStorage.getItem('usuario')\r\n                + \"&fechaElegida=\" + this.state.selectedDay.toLocaleDateString() + \"&horarioElegido=\" + this.state.horarioElegido)\r\n                .then(response => \r\n                    {\r\n                    if (response.status === 200) {\r\n                        this.setState({ mensaje: \"Ingreso Correcto\", mensajeSuccess: \"ok\" });\r\n                    }else {\r\n                        this.setState({ mensaje: \"Ingreso Incorrecto\",mensajeError:\"error\" });\r\n                    }\r\n                }).catch(error => {\r\n                    console.log(error);\r\n                    this.setState({ mensaje: \"Ingreso Incorrecto\", mensajeError: \"error\" });\r\n                })\r\n        }\r\n    }\r\n\r\n    componentDidMount = () => {\r\n        axios.get(url + '/servicio/listarActivos').then((resp) => {\r\n            this.setState({\r\n                servicios: resp.data,\r\n            });\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )\r\n        axios.get(url + '/servicioAgendado/listarActivos').then((resp) => {\r\n            this.setState({\r\n                serviciosAgendados: resp.data,\r\n            });\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )\r\n        axios.get(url + '/servicioAgendado/listarAgenda?num=3').then((resp) => {\r\n            this.setState({\r\n                serviciosFull: resp.data,\r\n            });\r\n            this.cargarFecha()\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )\r\n    };\r\n\r\n   \r\n\r\n    cargarFecha = () => {\r\n        const today = new Date();\r\n        const fechasAntes = [{ before: today }];\r\n        const fechas = fechasAntes;\r\n        this.state.serviciosFull.forEach(e => {\r\n            fechas.push(new Date(e))\r\n        });\r\n        this.setState({\r\n            fechasConvertidas: fechas,\r\n        })        \r\n    }\r\n\r\n    handleChange = event => {        \r\n        if (event.target.value == 3) {\r\n            this.setState({\r\n                horas: [{ hora: '9 am' }]\r\n            })\r\n        } else {\r\n            this.setState({\r\n                horas: this.state.horarios\r\n            })\r\n        }\r\n        this.setState({\r\n            idSer: event.target.value,\r\n        });               \r\n    }\r\n\r\n    changeHorario = event => {        \r\n        this.setState({\r\n            horarioElegido: event.target.value,\r\n        });\r\n    }\r\n\r\n    handleDayClick = (day, { selected, disabled }) => {\r\n        if (disabled) {\r\n            return;\r\n        }\r\n        if (selected) {\r\n            this.setState({ selectedDay: undefined });\r\n            return;\r\n        } else{\r\n            this.setState({\r\n                selectedDay: day,\r\n               \r\n        }); \r\n        this.llamarDia(day);     \r\n        }\r\n            \r\n    }\r\n\r\n    llamarDia = (day) => {        \r\n        this.setState({\r\n            horas:this.state.horarios,\r\n        })\r\n        axios.get(url + '/servicioAgendado/llamarServicioDia?dia=' + day.toLocaleDateString()).then((resp) => {\r\n            console.log(resp.data)\r\n            this.setState({\r\n                servicioDia: resp.data,\r\n            });\r\n            this.cargarFecha()\r\n            this.borrarHoras(resp.data);\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )       \r\n    }\r\n\r\n    borrarHoras = (servicioDia) => {\r\n        let array = this.state.horas;\r\n        servicioDia.forEach(e => {\r\n            if (e.servicioId === 1) {\r\n                let h = e.horaElegida;\r\n                array = array.filter(element => element.hora !== h);\r\n            } else if (e.servicioId === 2) {\r\n                let j = e.horaElegida;                \r\n                console.log(j)\r\n            }\r\n        });\r\n        this.setState({\r\n            horas: array,\r\n        })\r\n    }\r\n\r\n\r\n    render() {\r\n        if(localStorage.getItem('usuario') == null){\r\n            return  <Redirect to={window.location.href='/Login'}/>\r\n        }else\r\n        //var holydays = [new Date('08/22/2021'), new Date('08/25/2021'), new Date('08/29/2021')];       \r\n        return (\r\n            <div>\r\n                <h1>Agende su servicio</h1>\r\n                <div className=\"container\">\r\n                    <label id=\"labeles\" className=\"lead\" >Agende su servicio</label>\r\n                    <span style={{color: \"red\"}}>{this.state.errors[\"idSer\"]}</span>\r\n                    <div className=\"\">\r\n                        <select\r\n                            id='idSer'\r\n                            onChange={this.handleChange}\r\n                            className=\"form-control\"\r\n                            placeholderText=\"Servicios\">\r\n                            <option disabled selected >Eliga un servicio</option>\r\n                            {this.state.servicios.map(servicioElegido => (\r\n                                <option\r\n                                    key={servicioElegido}\r\n                                    name=\"servicio\"\r\n                                    value={servicioElegido.id}\r\n                                    selectedValue={servicioElegido}\r\n                                >{servicioElegido.nombre}</option>\r\n                            ))}</select>\r\n\r\n                        <br />\r\n                        <form onSubmit={this.submit}>\r\n                            <br />\r\n                            <span style={{color: \"red\"}}>{this.state.errors[\"fechaElegida\"]}</span>\r\n                            <div>\r\n                                <DayPicker\r\n                                    id='fechaElegida'\r\n                                    onDayClick={this.handleDayClick}\r\n                                    selectedDays={this.state.selectedDay}\r\n                                    disabledDays={this.state.fechasConvertidas}\r\n                                />\r\n                                {this.state.selectedDay ? (\r\n                                    <p>{this.state.selectedDay.toLocaleDateString()}</p>\r\n                                ) : (\r\n                                    <p>Elija un día.</p>\r\n                                )}\r\n                            </div>\r\n                            <br />\r\n                            <label id=\"labeles\" className=\"lead\" >Ingrese su horario</label>\r\n                            <span style={{color: \"red\"}}>{this.state.errors[\"horarioElegido\"]}</span>\r\n                            <select onChange={this.changeHorario}\r\n                                id='horarioElegido'\r\n                                className=\"form-control\"\r\n                                placeholderText=\"Horarios\">\r\n                                <option disabled selected >Eliga un horario</option>\r\n                                {this.state.horas.map(horario => (\r\n                                    <option\r\n                                        key={horario}\r\n                                        name=\"horario\"\r\n                                        value={horario.hora}\r\n                                        selectedValue={horario}\r\n                                    >{horario.hora}</option>\r\n                                ))}\r\n                            </select>\r\n                            <br />\r\n                            <ReactBoostrap.Button type=\"submit\" variant=\"success\" className=\"fadeIn fourth\" value=\"Crear Servicio\"\r\n                                onClick={this.manejadorBoton}>Agendar Servicio</ReactBoostrap.Button >\r\n                        </form>\r\n\r\n                        {this.state.mensajeSuccess === \"ok\" ?\r\n                            <div class=\"alert alert-success\" role=\"alert\">\r\n                                {this.state.mensaje}\r\n                            </div> : (this.state.mensajeError === \"error\") ?\r\n                                <div class=\"alert alert-danger\" role=\"alert\">\r\n                                    {this.state.mensaje}\r\n                                </div> : null\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}