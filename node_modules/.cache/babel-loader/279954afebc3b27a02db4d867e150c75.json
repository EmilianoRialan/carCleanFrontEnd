{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\emili\\\\Desktop\\\\proyecto car clean 01 09 2021\\\\proyecto\\\\src\\\\components\\\\Agenda\\\\AgendarServicio.js\";\nimport React, { Component } from 'react';\nimport * as ReactBoostrap from 'react-bootstrap';\nimport axios from 'axios';\nimport { url } from '../API.js';\nimport DayPicker from 'react-day-picker';\nimport 'react-day-picker/lib/style.css';\nimport { Redirect } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class AgendarServicio extends Component {\n  constructor(props) {\n    super(props);\n\n    this.manejadorBoton = e => {\n      e.preventDefault();\n      console.log(this.state.idSer);\n      console.log(localStorage.getItem('usuario') + 'id del usuario');\n      console.log(this.state.selectedDay);\n      console.log(this.state.horarioElegido);\n\n      if (this.handleValidation()) {\n        axios.post(url + '/servicioAgendado/insertar?idSer=' + this.state.idSer + \"&idUsu=\" + localStorage.getItem('usuario') + \"&fechaElegida=\" + this.state.selectedDay.toLocaleDateString() + \"&horarioElegido=\" + this.state.horarioElegido).then(response => {\n          if (response.status === 200) {\n            this.setState({\n              mensaje: \"Ingreso Correcto\",\n              mensajeSuccess: \"ok\"\n            });\n            return /*#__PURE__*/_jsxDEV(Redirect, {\n              to: window.location.href = '/AgendarServicio'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 32\n            }, this);\n          } else {\n            this.setState({\n              mensaje: \"Ingreso Incorrecto\",\n              mensajeError: \"error\"\n            });\n          }\n        }).catch(error => {\n          console.log(error);\n          this.setState({\n            mensaje: \"Ingreso Incorrecto\",\n            mensajeError: \"error\"\n          });\n        });\n      }\n    };\n\n    this.componentDidMount = () => {\n      axios.get(url + '/servicio/listarActivos').then(resp => {\n        this.setState({\n          servicios: resp.data\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n      axios.get(url + '/servicioAgendado/listarActivos').then(resp => {\n        this.setState({\n          serviciosAgendados: resp.data\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n      axios.get(url + '/servicioAgendado/listarAgenda?num=3').then(resp => {\n        this.setState({\n          serviciosFull: resp.data\n        });\n        this.cargarFecha();\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.cargarFecha = () => {\n      const today = new Date();\n      const fechasAntes = [{\n        before: today\n      }];\n      const fechas = fechasAntes;\n      this.state.serviciosFull.forEach(e => {\n        fechas.push(new Date(e));\n      });\n      this.setState({\n        fechasConvertidas: fechas\n      });\n    };\n\n    this.handleChange = event => {\n      this.setState({\n        idSer: event.target.value\n      });\n    };\n\n    this.changeHorario = event => {\n      this.setState({\n        horarioElegido: event.target.value\n      });\n    };\n\n    this.handleDayClick = (day, {\n      selected,\n      disabled\n    }) => {\n      if (disabled) {\n        return;\n      }\n\n      if (selected) {\n        this.setState({\n          selectedDay: undefined\n        });\n        return;\n      } else {\n        this.setState({\n          selectedDay: day\n        });\n        this.llamarDia(day);\n      }\n    };\n\n    this.llamarDia = day => {\n      axios.get(url + '/servicioAgendado/llamarServicioDia?dia=' + day.toLocaleDateString()).then(resp => {\n        this.setState({\n          servicioDia: resp.data\n        });\n        this.cargarFecha();\n        this.borrarHoras(resp.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.borrarHoras = servicioDia => {\n      let array = this.state.horarios;\n      console.log(array);\n      let idServicio = this.state.idSer;\n\n      if (idServicio === '3') {\n        array = [{\n          hora: '9 hrs'\n        }];\n      }\n\n      servicioDia.forEach(e => {\n        if (e.servicioId === 1) {\n          let h = e.horaElegida;\n          array = array.filter(element => element.hora !== h);\n        } else if (e.servicioId === 2) {\n          let hr = e.horaElegida;\n          let index = array.findIndex(e => e.hora == hr);\n          array.splice(index, index + 4);\n        }\n      });\n      this.setState({\n        horas: array\n      });\n    };\n\n    this.state = {\n      diaElegido: '',\n      servicios: [],\n      servicioElegido: \"\",\n      mensaje: \"\",\n      idCli: 0,\n      serviciosFull: [],\n      serviciosMedios: [],\n      serviciosBasicos: [],\n      selectedDay: \"\",\n      serviciosAgendados: [],\n      fechasConvertidas: {},\n      idSer: -1,\n      mensajeError: \"\",\n      mensajeSuccess: \"\",\n      horas: [],\n      horarios: [{\n        hora: \"9 hrs\"\n      }, {\n        hora: \"10 hrs\"\n      }, {\n        hora: \"11 hrs\"\n      }, {\n        hora: \"12 hrs\"\n      }, {\n        hora: \"14 hrs\"\n      }, {\n        hora: \"15 hrs\"\n      }, {\n        hora: \"16 hrs\"\n      }, {\n        hora: \"17 hrs\"\n      }, {\n        hora: \"18 hrs\"\n      }],\n      horarioElegido: \"\",\n      servicioDia: [],\n      errors: {}\n    };\n  }\n\n  handleValidation() {\n    let errors = {};\n    let formIsValid = true; //idSer\n\n    if (this.state.idSer === -1) {\n      formIsValid = false;\n      errors[\"idSer\"] = \"Debe ingresar el servicio que desea agendar\";\n    } //fechaElegida\n\n\n    if (this.state.selectedDay === \"\") {\n      formIsValid = false;\n      errors[\"fechaElegida\"] = \"Debe ingresar la fecha en la que desea agendarse\";\n    } //horarioElegido\n\n\n    if (this.state.horarioElegido === \"\") {\n      formIsValid = false;\n      errors[\"horarioElegido\"] = \"Debe ingresar el horario en el que desea agendarse\";\n    }\n\n    this.setState({\n      errors: errors\n    });\n    return formIsValid;\n  }\n\n  render() {\n    if (localStorage.getItem('usuario') === null) {\n      return /*#__PURE__*/_jsxDEV(Redirect, {\n        to: window.location.href = '/Login'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 20\n      }, this);\n    } else //var holydays = [new Date('08/22/2021'), new Date('08/25/2021'), new Date('08/29/2021')];       \n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Agende su servicio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            id: \"labeles\",\n            className: \"lead\",\n            children: \"Agende su servicio\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"red\"\n            },\n            children: this.state.errors[\"idSer\"]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"\",\n            children: [/*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"idSer\",\n              name: \"idSer\",\n              onChange: this.handleChange,\n              className: \"form-control\",\n              placeholderText: \"Servicios\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                disabled: true,\n                selected: true,\n                children: \"Eliga un servicio\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 222,\n                columnNumber: 33\n              }, this), this.state.servicios.map(servicioElegido => /*#__PURE__*/_jsxDEV(\"option\", {\n                name: \"servicio\",\n                value: servicioElegido.id,\n                selectedValue: servicioElegido,\n                children: servicioElegido.nombre\n              }, servicioElegido, false, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: this.submit,\n              children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: \"red\"\n                },\n                children: this.state.errors[\"fechaElegida\"]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(DayPicker, {\n                  id: \"fechaElegida\",\n                  name: \"fechaElegida\",\n                  onDayClick: this.handleDayClick,\n                  selectedDays: this.state.selectedDay,\n                  disabledDays: this.state.fechasConvertidas\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 37\n                }, this), this.state.selectedDay ? /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: this.state.selectedDay.toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 41\n                }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Elija un d\\xEDa.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                id: \"labeles\",\n                className: \"lead\",\n                children: \"Ingrese su horario\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  color: \"red\"\n                },\n                children: this.state.errors[\"horarioElegido\"]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                onChange: this.changeHorario,\n                id: \"horarioElegido\",\n                name: \"horarioElegido\",\n                className: \"form-control\",\n                placeholderText: \"Horarios\",\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  disabled: true,\n                  selected: true,\n                  children: \"Eliga un horario\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 37\n                }, this), this.state.horas.map(horario => /*#__PURE__*/_jsxDEV(\"option\", {\n                  name: \"horario\",\n                  value: horario.hora,\n                  selectedValue: horario,\n                  children: horario.hora\n                }, horario, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 260,\n                  columnNumber: 41\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(ReactBoostrap.Button, {\n                type: \"submit\",\n                variant: \"success\",\n                className: \"fadeIn fourth\",\n                value: \"Crear Servicio\",\n                onClick: this.manejadorBoton,\n                children: \"Agendar Servicio\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 29\n            }, this), this.state.mensajeSuccess === \"ok\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"alert alert-success\",\n              role: \"alert\",\n              children: this.state.mensaje\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 33\n            }, this) : this.state.mensajeError === \"error\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"alert alert-danger\",\n              role: \"alert\",\n              children: this.state.mensaje\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 37\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/emili/Desktop/proyecto car clean 01 09 2021/proyecto/src/components/Agenda/AgendarServicio.js"],"names":["React","Component","ReactBoostrap","axios","url","DayPicker","Redirect","AgendarServicio","constructor","props","manejadorBoton","e","preventDefault","console","log","state","idSer","localStorage","getItem","selectedDay","horarioElegido","handleValidation","post","toLocaleDateString","then","response","status","setState","mensaje","mensajeSuccess","window","location","href","mensajeError","catch","error","componentDidMount","get","resp","servicios","data","serviciosAgendados","serviciosFull","cargarFecha","today","Date","fechasAntes","before","fechas","forEach","push","fechasConvertidas","handleChange","event","target","value","changeHorario","handleDayClick","day","selected","disabled","undefined","llamarDia","servicioDia","borrarHoras","array","horarios","idServicio","hora","servicioId","h","horaElegida","filter","element","hr","index","findIndex","splice","horas","diaElegido","servicioElegido","idCli","serviciosMedios","serviciosBasicos","errors","formIsValid","render","color","map","id","nombre","submit","horario"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport * as ReactBoostrap from 'react-bootstrap';\r\nimport axios from 'axios'\r\nimport { url } from '../API.js';\r\nimport DayPicker from 'react-day-picker';\r\nimport 'react-day-picker/lib/style.css';\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\n\r\n\r\nexport default class AgendarServicio extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            diaElegido: '',\r\n            servicios: [],\r\n            servicioElegido: \"\",\r\n            mensaje: \"\",\r\n            idCli: 0,\r\n            serviciosFull: [],\r\n            serviciosMedios: [],\r\n            serviciosBasicos: [],\r\n            selectedDay: \"\",\r\n            serviciosAgendados: [],\r\n            fechasConvertidas: {},\r\n            idSer: (-1),\r\n            mensajeError: \"\",\r\n            mensajeSuccess: \"\",\r\n            horas: [],\r\n            horarios: [\r\n                { hora: \"9 hrs\" },\r\n                { hora: \"10 hrs\" },\r\n                { hora: \"11 hrs\" },\r\n                { hora: \"12 hrs\" },\r\n                { hora: \"14 hrs\" },\r\n                { hora: \"15 hrs\" },\r\n                { hora: \"16 hrs\" },\r\n                { hora: \"17 hrs\" },\r\n                { hora: \"18 hrs\" },\r\n            ],\r\n            horarioElegido: \"\",\r\n            servicioDia: [],\r\n            errors: {},\r\n        }\r\n    }\r\n\r\n    handleValidation() {\r\n       \r\n        let errors = {};\r\n        let formIsValid = true;\r\n\r\n        //idSer\r\n        if (this.state.idSer === -1) {\r\n            formIsValid = false;\r\n            errors[\"idSer\"] = \"Debe ingresar el servicio que desea agendar\";\r\n        }\r\n\r\n        //fechaElegida\r\n        if (this.state.selectedDay === \"\") {\r\n            formIsValid = false;\r\n            errors[\"fechaElegida\"] = \"Debe ingresar la fecha en la que desea agendarse\";\r\n        }\r\n\r\n        //horarioElegido\r\n        if (this.state.horarioElegido === \"\") {\r\n            formIsValid = false;\r\n            errors[\"horarioElegido\"] = \"Debe ingresar el horario en el que desea agendarse\";\r\n        }\r\n\r\n        this.setState({ errors: errors });\r\n        return formIsValid;\r\n    }\r\n\r\n    manejadorBoton = (e) => {\r\n        e.preventDefault();\r\n        console.log(this.state.idSer)\r\n        console.log(localStorage.getItem('usuario') + 'id del usuario')\r\n        console.log(this.state.selectedDay)\r\n        console.log(this.state.horarioElegido)\r\n        if (this.handleValidation()) {\r\n            axios.post(url + '/servicioAgendado/insertar?idSer=' + this.state.idSer + \"&idUsu=\" + localStorage.getItem('usuario')\r\n                + \"&fechaElegida=\" + this.state.selectedDay.toLocaleDateString() + \"&horarioElegido=\" + this.state.horarioElegido)\r\n                .then(response => {\r\n                    if (response.status === 200) {\r\n                        this.setState({ mensaje: \"Ingreso Correcto\", mensajeSuccess: \"ok\" });\r\n                        return <Redirect to={window.location.href = '/AgendarServicio'} />\r\n                    } else {\r\n                        this.setState({ mensaje: \"Ingreso Incorrecto\", mensajeError: \"error\" });\r\n                    }\r\n                }).catch(error => {\r\n                    console.log(error);\r\n                    this.setState({ mensaje: \"Ingreso Incorrecto\", mensajeError: \"error\" });\r\n                })\r\n        }\r\n    }\r\n\r\n    componentDidMount = () => {\r\n        axios.get(url + '/servicio/listarActivos').then((resp) => {\r\n            this.setState({\r\n                servicios: resp.data,\r\n            });\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )\r\n        axios.get(url + '/servicioAgendado/listarActivos').then((resp) => {\r\n            this.setState({\r\n                serviciosAgendados: resp.data,\r\n            });\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )\r\n        axios.get(url + '/servicioAgendado/listarAgenda?num=3').then((resp) => {\r\n            this.setState({\r\n                serviciosFull: resp.data,\r\n            });\r\n            this.cargarFecha()\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )\r\n    };\r\n\r\n\r\n\r\n    cargarFecha = () => {\r\n        const today = new Date();\r\n        const fechasAntes = [{ before: today }];\r\n        const fechas = fechasAntes;\r\n        this.state.serviciosFull.forEach(e => {\r\n            fechas.push(new Date(e))\r\n        });\r\n        this.setState({\r\n            fechasConvertidas: fechas,\r\n        })\r\n    }\r\n\r\n    handleChange = event => {\r\n        this.setState({\r\n            idSer: event.target.value,\r\n        });\r\n    }\r\n\r\n    changeHorario = event => {\r\n        this.setState({\r\n            horarioElegido: event.target.value,\r\n        });\r\n    }\r\n\r\n    handleDayClick = (day, { selected, disabled }) => {\r\n        if (disabled) {\r\n            return;\r\n        }\r\n        if (selected) {\r\n            this.setState({ selectedDay: undefined });\r\n            return;\r\n        } else {\r\n            this.setState({\r\n                selectedDay: day,              \r\n            });\r\n            this.llamarDia(day);\r\n        }\r\n\r\n    }\r\n\r\n    llamarDia = (day) => {\r\n        axios.get(url + '/servicioAgendado/llamarServicioDia?dia=' + day.toLocaleDateString()).then((resp) => {\r\n            this.setState({\r\n                servicioDia: resp.data,\r\n            });\r\n            this.cargarFecha()\r\n            this.borrarHoras(resp.data);\r\n        }).catch((error) => {\r\n            console.log(error);\r\n        }\r\n        )\r\n    }\r\n\r\n    borrarHoras = (servicioDia) => {        \r\n        let array = this.state.horarios;\r\n        console.log(array)\r\n        let idServicio = this.state.idSer;\r\n        if (idServicio === '3') {\r\n            array = [{ hora: '9 hrs' }]\r\n        }\r\n        servicioDia.forEach(e => {\r\n            if (e.servicioId === 1) {\r\n                let h = e.horaElegida;\r\n                array = array.filter(element => element.hora !== h);\r\n            } else if (e.servicioId === 2) {                \r\n                let hr = e.horaElegida;\r\n                let index = array.findIndex(e => e.hora == hr); \r\n                array.splice(index, index+4); \r\n            }\r\n        });\r\n        this.setState({\r\n            horas: array,\r\n        })\r\n    }\r\n\r\n\r\n    render() {\r\n        if (localStorage.getItem('usuario') === null) {\r\n            return <Redirect to={window.location.href = '/Login'} />\r\n        } else\r\n            //var holydays = [new Date('08/22/2021'), new Date('08/25/2021'), new Date('08/29/2021')];       \r\n            return (\r\n                <div>\r\n                    <h1>Agende su servicio</h1>\r\n                    <div className=\"container\">\r\n                        <label id=\"labeles\" className=\"lead\" >Agende su servicio</label>\r\n                        <span style={{ color: \"red\" }}>{this.state.errors[\"idSer\"]}</span>\r\n                        <div className=\"\">\r\n                            <select\r\n                                id='idSer'\r\n                                name='idSer'\r\n                                onChange={this.handleChange}\r\n                                className=\"form-control\"\r\n                                placeholderText=\"Servicios\">\r\n                                <option disabled selected >Eliga un servicio</option>\r\n                                {this.state.servicios.map(servicioElegido => (\r\n                                    <option\r\n                                        key={servicioElegido}\r\n                                        name=\"servicio\"\r\n                                        value={servicioElegido.id}\r\n                                        selectedValue={servicioElegido}\r\n                                    >{servicioElegido.nombre}</option>\r\n                                ))}</select>\r\n\r\n                            <br />\r\n                            <form onSubmit={this.submit}>\r\n                                <br />\r\n                                <span style={{ color: \"red\" }}>{this.state.errors[\"fechaElegida\"]}</span>\r\n                                <div>\r\n                                    <DayPicker\r\n                                        id='fechaElegida'\r\n                                        name='fechaElegida'\r\n                                        onDayClick={this.handleDayClick}\r\n                                        selectedDays={this.state.selectedDay}\r\n                                        disabledDays={this.state.fechasConvertidas}\r\n                                    />\r\n                                    {this.state.selectedDay ? (\r\n                                        <p>{this.state.selectedDay.toLocaleDateString()}</p>\r\n                                    ) : (\r\n                                        <p>Elija un día.</p>\r\n                                    )}\r\n                                </div>\r\n                                <br />\r\n                                <label id=\"labeles\" className=\"lead\" >Ingrese su horario</label>\r\n                                <span style={{ color: \"red\" }}>{this.state.errors[\"horarioElegido\"]}</span>\r\n                                <select onChange={this.changeHorario}\r\n                                    id='horarioElegido'\r\n                                    name='horarioElegido'\r\n                                    className=\"form-control\"\r\n                                    placeholderText=\"Horarios\">\r\n                                    <option disabled selected >Eliga un horario</option>\r\n                                    {this.state.horas.map(horario => (\r\n                                        <option\r\n                                            key={horario}\r\n                                            name=\"horario\"\r\n                                            value={horario.hora}\r\n                                            selectedValue={horario}\r\n                                        >{horario.hora}</option>\r\n                                    ))}\r\n                                </select>\r\n                                <br />\r\n                                <ReactBoostrap.Button type=\"submit\" variant=\"success\" className=\"fadeIn fourth\" value=\"Crear Servicio\"\r\n                                    onClick={this.manejadorBoton}>Agendar Servicio</ReactBoostrap.Button >\r\n                            </form>\r\n\r\n                            {this.state.mensajeSuccess === \"ok\" ?\r\n                                <div class=\"alert alert-success\" role=\"alert\">\r\n                                    {this.state.mensaje}\r\n                                </div> : (this.state.mensajeError === \"error\") ?\r\n                                    <div class=\"alert alert-danger\" role=\"alert\">\r\n                                        {this.state.mensaje}\r\n                                    </div> : null\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}